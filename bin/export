#!/bin/bash
function getHead {
	heads=(`mysql -uroot -p123456 -e "select column_name from information_schema.columns where table_name='$2' and table_schema='$1'"`)
	index=2
	total=${#heads[*]}
	echo -e "${heads[1]}\c"
	while [ ${index} -lt ${total} ]
	do
		echo -e "|${heads[${index}]}\c"
		let "index++"
	done
}

function transFile {
	mysqldump -u root -p123456 test import_data_x -T /var/lib/mysql-files/ --fields-terminated-by='|'
	mv /var/lib/mysql-files/$2.txt ./$1_$2.txt
	sed -i "1i\\`getHead $1 $2`" ./$1_$2.txt
}

func pri {
	echo $1
}

ls /home/arch/sql/data | xargs -P 2 -n 1 -I {} sh -c "sleep 1;pri {}"
